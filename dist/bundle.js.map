{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/visualization.js"],"names":["document","addEventListener","object","getDataObject","url","getUrlFromObject","console","log","visualization","jsonse","JSON","stringify","blob","Blob","type","URL","createObjectURL","d3","window","units","margin","top","right","bottom","left","width","height","color","scaleOrdinal","range","formatNumber","format","d","svg","select","append","attr","classed","sankey","nodeWidth","nodePadding","size","path","link","strokeColor","json","error","graph","nodes","links","layout","selectAll","data","enter","style","Math","max","dy","i","sort","a","b","text","source","name","target","value","node","x","y","call","drag","subject","on","parentNode","appendChild","dragmove","replace","rgb","darker","filter","min","dx","event","relayout","_","arguments","length","iterations","computeNodeLinks","computeNodeValues","computeNodeBreadths","computeNodeDepths","computeLinkDepths","curvature","x0","x1","xi","interpolateNumber","x2","x3","y0","sy","y1","ty","forEach","sourceLinks","targetLinks","push","sum","remainingNodes","nextNodes","indexOf","moveSinksRight","scaleNodeBreadths","moveSourcesRight","kx","nodesByBreadth","nest","key","sortKeys","ascending","entries","map","values","initializeNodeDepth","resolveCollisions","alpha","relaxRightToLeft","relaxLeftToRight","ky","breadth","weightedSource","center","slice","reverse","weightedTarget","n","ascendingDepth","ascendingTargetDepth","ascendingSourceDepth"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import visualization from './visualization';\n\ndocument.addEventListener(\"DOMContentLoaded\", ()=>{\n    const object = getDataObject();\n    const url = getUrlFromObject(object);\n    console.log(url);\n\n    visualization(url)\n})\n\nfunction getUrlFromObject(object) {\n    var jsonse = JSON.stringify(object);\n    var blob = new Blob([jsonse], { type: \"application/json\" });\n    var url = URL.createObjectURL(blob);\n    return url;\n}\n\nfunction getDataObject(){\n    return {\n        \"nodes\": [\n            {\n                \"node\": 0,\n                \"name\": \"Salary\"\n            },\n            {\n                \"node\": 1,\n                \"name\": \"Investment Return\"\n            },\n            {\n                \"node\": 2,\n                \"name\": \"Income\"\n            },\n            {\n                \"node\": 3,\n                \"name\": \"Savings\"\n            },\n            {\n                \"node\": 4,\n                \"name\": \"Investments\"\n            },\n            {\n                \"node\": 5,\n                \"name\": \"Expenses\"\n            },\n            {\n                \"node\": 6,\n                \"name\": \"Taxes\"\n            },\n            {\n                \"node\": 7,\n                \"name\": \"Saved\"\n            },\n            {\n                \"node\": 8,\n                \"name\": \"Spent\"\n            }\n        ],\n        \"links\": [\n            {\n                \"source\": 0,\n                \"target\": 2,\n                \"value\": 75000\n            },\n            {\n                \"source\": 1,\n                \"target\": 2,\n                \"value\": 5000\n            },\n            {\n                \"source\": 2,\n                \"target\": 3,\n                \"value\": 12000\n            },\n            {\n                \"source\": 2,\n                \"target\": 4,\n                \"value\": 4000\n            },\n            {\n                \"source\": 2,\n                \"target\": 5,\n                \"value\": 36000\n            },\n            {\n                \"source\": 2,\n                \"target\": 6,\n                \"value\": 28000\n            },\n            {\n                \"source\": 3,\n                \"target\": 7,\n                \"value\": 12000\n            },\n            {\n                \"source\": 4,\n                \"target\": 7,\n                \"value\": 4000\n            },\n            {\n                \"source\": 5,\n                \"target\": 8,\n                \"value\": 36000\n            },\n            {\n                \"source\": 6,\n                \"target\": 8,\n                \"value\": 28000\n            }    \n        ]\n    }\n}","\n// import * as d3 from 'd3';\n\nconst d3 = window.d3;\n\nexport default (url) => {\nvar units = \"dollars\";\n\n// set the dimensions and margins of the graph\nvar margin = { top: 10, right: 10, bottom: 10, left: 10 },\n    width = 700 - margin.left - margin.right,\n    height = 300 - margin.top - margin.bottom;\n    // width = 1400 - margin.left - margin.right,\n    // height = 700 - margin.top - margin.bottom;\n\n// format variables\nvar color = d3.scaleOrdinal().range([\n    \"rgba(45, 165, 239, 0.75)\", \n    \"rgba(78, 244, 242, 0.75)\",\n\n    \"rgb(37, 90, 234)\",\n\n    \"rgba(45, 165, 239, 1)\",\n    \"rgba(78, 244, 242, 1)\",\n    \"rgb(239, 237, 91)\",\n    \"rgb(247, 168, 236)\",\n\n    \"rgb(33, 237, 97)\",\n    \"rgb(239, 43, 49)\"\n]);\nvar formatNumber = d3.format(\",.0f\"),    // zero decimal places\n    format = function (d) { return formatNumber(d) + \" \" + units; },\n    color;\n\n// append the svg object to the body of the page\nvar svg = d3.select(\".visualization\").append(\"svg\")\n    .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n    .attr(\"viewBox\", \"0 0 700 350\")\n    // .attr(\"width\", width + margin.left + margin.right)\n    // .attr(\"height\", height + margin.top + margin.bottom)\n    .classed(\"inner-svg\", true)\n    .append(\"g\")\n    .attr(\"transform\",\n        \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n// Set the sankey diagram properties\nvar sankey = d3.sankey()\n    .nodeWidth(36)\n    .nodePadding(40)\n    .size([width, height]);\nvar path = sankey.link();\n\nconst strokeColor = [\n        \"rgb(37, 90, 234)\",\n        \"rgb(37, 90, 234)\",\n\n        \"rgba(45, 165, 239, 1)\",\n        \"rgba(78, 244, 242, 1)\",\n        \"rgb(239, 237, 91)\",\n        \"rgb(247, 168, 236)\",\n\n        \"rgb(33, 237, 97)\",\n        \"rgb(33, 237, 97)\",\n        \"rgb(239, 43, 49)\",\n        \"rgb(239, 43, 49)\",\n    ];\n\n// load the data\n// d3.json('./src/data/data.json', function (error, graph) {\nd3.json(url, function (error, graph) {\n    sankey\n        .nodes(graph.nodes)\n        .links(graph.links)\n        .layout(32);\n        \n    // add in the links\n    var link = svg.append(\"g\").selectAll(\".link\")\n        .data(graph.links)\n        .enter().append(\"path\")\n        .attr(\"class\", \"link\")\n        .attr(\"d\", path)\n        .style(\"stroke-width\", function (d) { return Math.max(1, d.dy); })\n        .style(\"stroke\", function (d, i) {\n            return d.color = strokeColor[i];\n        })\n        .sort(function (a, b) { return b.dy - a.dy; });\n\n    // add the link titles\n    link.append(\"title\")\n        .text(function (d) {\n            return d.source.name + \" â†’ \" +\n                d.target.name + \"\\n\" + format(d.value);\n        });\n\n    // add in the nodes\n    var node = svg.append(\"g\").selectAll(\".node\")\n        .data(graph.nodes)\n        .enter().append(\"g\")\n        .attr(\"class\", \"node\")\n        .attr(\"transform\", function (d) {\n            return \"translate(\" + d.x + \",\" + d.y + \")\";\n        })\n        .call(d3.drag()\n            .subject(function (d) {\n                return d;\n            })\n            .on(\"start\", function () {\n                this.parentNode.appendChild(this);\n            })\n            .on(\"drag\", dragmove));\n\n    // add the rectangles for the nodes\n    node.append(\"rect\")\n        .attr(\"height\", function (d) { return d.dy; })\n        .attr(\"width\", sankey.nodeWidth())\n        .style(\"fill\", function (d) {\n            return d.color = color(d.name.replace(/ .*/, \"\"));\n        })\n        .style(\"stroke\", function (d) {\n            return d3.rgb(d.color).darker(2);\n        })\n        .append(\"title\")\n        .text(function (d) {\n            return d.name + \"\\n\" + format(d.value);\n        });\n\n    // add in the title for the nodes\n    node.append(\"text\")\n        .attr(\"x\", -6)\n        .attr(\"y\", function (d) { return d.dy / 2; })\n        .attr(\"dy\", \".35em\")\n        .attr(\"text-anchor\", \"end\")\n        .attr(\"transform\", null)\n        .text(function (d) { return d.name; })\n        .filter(function (d) { return d.x < width / 2; })\n        .attr(\"x\", 6 + sankey.nodeWidth())\n        .attr(\"text-anchor\", \"start\");\n\n    // the function for moving the nodes\n    function dragmove(d) {\n        d3.select(this)\n            .attr(\"transform\",\n                \"translate(\" + (\n                    d.x = Math.max(0, Math.min(width - d.dx, d3.event.x))\n                )\n                + \",\" + (\n                    d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))\n                ) + \")\");\n        sankey.relayout();\n        link.attr(\"d\", path);\n    }\n});\n}\n\nd3.sankey = function () {\n    var sankey = {},\n        nodeWidth = 24,\n        nodePadding = 8,\n        size = [1, 1],\n        nodes = [],\n        links = [];\n\n    sankey.nodeWidth = function (_) {\n        if (!arguments.length) return nodeWidth;\n        nodeWidth = +_;\n        return sankey;\n    };\n\n    sankey.nodePadding = function (_) {\n        if (!arguments.length) return nodePadding;\n        nodePadding = +_;\n        return sankey;\n    };\n\n    sankey.nodes = function (_) {\n        if (!arguments.length) return nodes;\n        nodes = _;\n        return sankey;\n    };\n\n    sankey.links = function (_) {\n        if (!arguments.length) return links;\n        links = _;\n        return sankey;\n    };\n\n    sankey.size = function (_) {\n        if (!arguments.length) return size;\n        size = _;\n        return sankey;\n    };\n\n    sankey.layout = function (iterations) {\n        computeNodeLinks();\n        computeNodeValues();\n        computeNodeBreadths();\n        computeNodeDepths(iterations);\n        computeLinkDepths();\n        return sankey;\n    };\n\n    sankey.relayout = function () {\n        computeLinkDepths();\n        return sankey;\n    };\n\n    sankey.link = function () {\n        var curvature = .5;\n\n        function link(d) {\n            var x0 = d.source.x + d.source.dx,\n                x1 = d.target.x,\n                xi = d3.interpolateNumber(x0, x1),\n                x2 = xi(curvature),\n                x3 = xi(1 - curvature),\n                y0 = d.source.y + d.sy + d.dy / 2,\n                y1 = d.target.y + d.ty + d.dy / 2;\n            return \"M\" + x0 + \",\" + y0\n                + \"C\" + x2 + \",\" + y0\n                + \" \" + x3 + \",\" + y1\n                + \" \" + x1 + \",\" + y1;\n        }\n\n        link.curvature = function (_) {\n            if (!arguments.length) return curvature;\n            curvature = +_;\n            return link;\n        };\n\n        return link;\n    };\n\n    // Populate the sourceLinks and targetLinks for each node.\n    // Also, if the source and target are not objects, assume they are indices.\n    function computeNodeLinks() {\n        nodes.forEach(function (node) {\n            node.sourceLinks = [];\n            node.targetLinks = [];\n        });\n        links.forEach(function (link) {\n            var source = link.source,\n                target = link.target;\n            if (typeof source === \"number\") source = link.source = nodes[link.source];\n            if (typeof target === \"number\") target = link.target = nodes[link.target];\n            source.sourceLinks.push(link);\n            target.targetLinks.push(link);\n        });\n    }\n\n    // Compute the value (size) of each node by summing the associated links.\n    function computeNodeValues() {\n        nodes.forEach(function (node) {\n            node.value = Math.max(\n                d3.sum(node.sourceLinks, value),\n                d3.sum(node.targetLinks, value)\n            );\n        });\n    }\n\n    // Iteratively assign the breadth (x-position) for each node.\n    // Nodes are assigned the maximum breadth of incoming neighbors plus one;\n    // nodes with no incoming links are assigned breadth zero, while\n    // nodes with no outgoing links are assigned the maximum breadth.\n    function computeNodeBreadths() {\n        var remainingNodes = nodes,\n            nextNodes,\n            x = 0;\n\n        while (remainingNodes.length) {\n            nextNodes = [];\n            remainingNodes.forEach(function (node) {\n                node.x = x;\n                node.dx = nodeWidth;\n                node.sourceLinks.forEach(function (link) {\n                    if (nextNodes.indexOf(link.target) < 0) {\n                        nextNodes.push(link.target);\n                    }\n                });\n            });\n            remainingNodes = nextNodes;\n            ++x;\n        }\n\n        //\n        moveSinksRight(x);\n        scaleNodeBreadths((size[0] - nodeWidth) / (x - 1));\n    }\n\n    function moveSourcesRight() {\n        nodes.forEach(function (node) {\n            if (!node.targetLinks.length) {\n                node.x = d3.min(node.sourceLinks, function (d) { return d.target.x; }) - 1;\n            }\n        });\n    }\n\n    function moveSinksRight(x) {\n        nodes.forEach(function (node) {\n            if (!node.sourceLinks.length) {\n                node.x = x - 1;\n            }\n        });\n    }\n\n    function scaleNodeBreadths(kx) {\n        nodes.forEach(function (node) {\n            node.x *= kx;\n        });\n    }\n\n    function computeNodeDepths(iterations) {\n        var nodesByBreadth = d3.nest()\n            .key(function (d) { return d.x; })\n            .sortKeys(d3.ascending)\n            .entries(nodes)\n            .map(function (d) { return d.values; });\n\n        //\n        initializeNodeDepth();\n        resolveCollisions();\n        for (var alpha = 1; iterations > 0; --iterations) {\n            relaxRightToLeft(alpha *= .99);\n            resolveCollisions();\n            relaxLeftToRight(alpha);\n            resolveCollisions();\n        }\n\n        function initializeNodeDepth() {\n            var ky = d3.min(nodesByBreadth, function (nodes) {\n                return (size[1] - (nodes.length - 1) * nodePadding) / d3.sum(nodes, value);\n            });\n\n            nodesByBreadth.forEach(function (nodes) {\n                nodes.forEach(function (node, i) {\n                    node.y = i;\n                    node.dy = node.value * ky;\n                });\n            });\n\n            links.forEach(function (link) {\n                link.dy = link.value * ky;\n            });\n        }\n\n        function relaxLeftToRight(alpha) {\n            nodesByBreadth.forEach(function (nodes, breadth) {\n                nodes.forEach(function (node) {\n                    if (node.targetLinks.length) {\n                        var y = d3.sum(node.targetLinks, weightedSource) / d3.sum(node.targetLinks, value);\n                        node.y += (y - center(node)) * alpha;\n                    }\n                });\n            });\n\n            function weightedSource(link) {\n                return center(link.source) * link.value;\n            }\n        }\n\n        function relaxRightToLeft(alpha) {\n            nodesByBreadth.slice().reverse().forEach(function (nodes) {\n                nodes.forEach(function (node) {\n                    if (node.sourceLinks.length) {\n                        var y = d3.sum(node.sourceLinks, weightedTarget) / d3.sum(node.sourceLinks, value);\n                        node.y += (y - center(node)) * alpha;\n                    }\n                });\n            });\n\n            function weightedTarget(link) {\n                return center(link.target) * link.value;\n            }\n        }\n\n        function resolveCollisions() {\n            nodesByBreadth.forEach(function (nodes) {\n                var node,\n                    dy,\n                    y0 = 0,\n                    n = nodes.length,\n                    i;\n\n                // Push any overlapping nodes down.\n                nodes.sort(ascendingDepth);\n                for (i = 0; i < n; ++i) {\n                    node = nodes[i];\n                    dy = y0 - node.y;\n                    if (dy > 0) node.y += dy;\n                    y0 = node.y + node.dy + nodePadding;\n                }\n\n                // If the bottommost node goes outside the bounds, push it back up.\n                dy = y0 - nodePadding - size[1];\n                if (dy > 0) {\n                    y0 = node.y -= dy;\n\n                    // Push any overlapping nodes back up.\n                    for (i = n - 2; i >= 0; --i) {\n                        node = nodes[i];\n                        dy = node.y + node.dy + nodePadding - y0;\n                        if (dy > 0) node.y -= dy;\n                        y0 = node.y;\n                    }\n                }\n            });\n        }\n\n        function ascendingDepth(a, b) {\n            return a.y - b.y;\n        }\n    }\n\n    function computeLinkDepths() {\n        nodes.forEach(function (node) {\n            node.sourceLinks.sort(ascendingTargetDepth);\n            node.targetLinks.sort(ascendingSourceDepth);\n        });\n        nodes.forEach(function (node) {\n            var sy = 0, ty = 0;\n            node.sourceLinks.forEach(function (link) {\n                link.sy = sy;\n                sy += link.dy;\n            });\n            node.targetLinks.forEach(function (link) {\n                link.ty = ty;\n                ty += link.dy;\n            });\n        });\n\n        function ascendingSourceDepth(a, b) {\n            return a.source.y - b.source.y;\n        }\n\n        function ascendingTargetDepth(a, b) {\n            return a.target.y - b.target.y;\n        }\n    }\n\n    function center(node) {\n        return node.y + node.dy / 2;\n    }\n\n    function value(link) {\n        return link.value;\n    }\n\n    return sankey;\n};"],"sourceRoot":""}